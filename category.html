<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Foody - Menu</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@600&family=Inter:wght@400;600&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    .blurred {
      filter: blur(5px);
      pointer-events: none; /* To ensure the background doesn't interfere with clicks while blurred */
    }

    body {
      font-family: 'Inter', sans-serif;
      background-color: #f3f0f0;
      color: #1a1a1a;
      padding: 2rem;
      /* Use responsive padding with rem */
      padding-left: 2rem;
      padding-right: 2rem;
    }

    header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 2rem;
    }

    nav a {
      margin: 0 1rem;
      text-decoration: none;
      color: #333;
      font-weight: 500;
    }

    .logo {
      font-family: 'Playfair Display', serif;
      font-size: 1.8rem;
      color: #222;
    }

    .menu-section {
      max-width: 1000px;
      margin: 0 auto;
      padding: 2rem 1rem; /* Responsive padding */
    }

    .menu-section h2 {
      font-family: 'Playfair Display', serif;
      font-size: 2.5rem;
      margin-bottom: 2rem;
      text-align: center;
    }

    .category {
      margin: 2rem 0 1rem;
      font-size: 1.5rem;
      font-weight: 600;
      color: #444;
    }

    .menu-items {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1.5rem;
    }

    .menu-card {
      background: white;
      border-radius: 20px;
      padding: 1rem;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      text-align: center;
      cursor: pointer;
    }

    .menu-card img {
      width: 100%;
      height: 180px;
      object-fit: cover;
      border-radius: 15px;
      margin-bottom: 1rem;
    }

    .menu-name {
      font-weight: 600;
      font-size: 1.2rem;
      margin: 0.5rem 0;
    }

    .menu-desc {
      color: #666;
      font-size: 0.9rem;
      margin-bottom: 0.5rem;
    }

    .menu-price {
      color: #e53935;
      font-weight: bold;
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 0.3s ease;
    }

    .food-selection-container {
      background: #fff;
      padding: 2rem;
      border-radius: 15px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transform: scale(0.9);
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .food-selection-container.active {
      transform: scale(1);
      opacity: 1;
    }

    #food-img {
      width: 100%;
      height: 200px;
      object-fit: cover;
      border-radius: 15px;
      margin-bottom: 20px;
      transition: transform 0.3s ease;
    }

    .food-title {
      font-size: 1.6rem;
      color: #333;
      font-weight: 600;
      margin: 10px 0;
    }

    .food-price {
      font-size: 1.2rem;
      color: #e53935;
      font-weight: 600;
      margin-bottom: 20px;
    }

    input, select, button {
      width: 100%;
      padding: 1rem;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: 8px;
      font-size: 1rem;
    }

    input:focus, select:focus {
      border-color: #e53935;
      outline: none;
    }

    button {
      background-color: #e53935;
      color: white;
      font-weight: bold;
      cursor: pointer;
      border: none;
      transition: background-color 0.3s ease;
    }

    button:hover {
      background-color: #d32f2f;
    }

    .scroll-container {
      overflow-x: auto;
      white-space: nowrap;
      padding-bottom: 1rem;
    }

    .scroll-container .menu-card {
      display: inline-block;
      width: 250px;
      vertical-align: top;
      margin-right: 1rem;
    }

    /* Modal Styles for Payment and Order Review */
    .payment-method-container {
      background: #fff;
      padding: 2rem;
      border-radius: 15px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transform: scale(0.9);
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .payment-method-container.active {
      transform: scale(1);
      opacity: 1;
    }

    /* Order Review Modal Styles */
    .review-container {
      background: #fff;
      padding: 2rem;
      border-radius: 15px;
      max-width: 400px;
      width: 90%;
      text-align: center;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
      transform: scale(0.9);
      transition: transform 0.3s ease, opacity 0.3s ease;
    }

    .review-container.active {
      transform: scale(1);
      opacity: 1;
    }

    .order-summary {
      list-style-type: none;
      padding: 0;
      margin: 20px 0;
    }

    .order-summary li {
      font-size: 1rem;
      color: #333;
      margin-bottom: 10px;
    }

    .order-summary li span {
      font-weight: bold;
    }

    /* Overlay */
    #overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      display: none;
      z-index: 999;
      transition: opacity 0.3s ease;
    }

    .selected {
      background-color: #4CAF50; 
      color: white;
    }

    .blurred {
      filter: blur(5px);
    }

    #payment-method-container, #order-summary, #review-container {
      text-align: center;
    }

    #payment-inputs input {
      margin-top: 10px;
      width: 100%;
    }
</style>
</head>
<body>
  <header>
    <div class="logo">Foody</div>
    <nav>
      <a href="home.html">Home</a>
      <a href="category.html">Menu</a>
      <a href="#">About Us</a>
      <a href="#">Contact</a>
     <button onclick="showOrderHistory()" style="z-index: 10001;">Order History</button>
    </nav>
</nav>
  </header>
  <section class="menu-section">
    <h2>Our Menu</h2>
  
    <!-- Coffee -->
    <div class="category">Coffee</div>
    <div class="scroll-container">
      <div class="menu-card">
        <img src="coff.jpg" alt="Cappuccino">
        <div class="menu-name">Cappuccino</div>
        <div class="menu-desc">Smooth espresso with steamed milk</div>
        <div class="menu-price">₱49.00</div>
          <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="black-coffe.avif" alt="Latte">
        <div class="menu-name">Latte</div>
        <div class="menu-desc">Espresso with milk and foam</div>
        <div class="menu-price">₱59.50</div>
                  <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="brown-coffee.jpg" alt="Mocha">
        <div class="menu-name">Mocha</div>
        <div class="menu-desc">Espresso with chocolate and milk</div>
        <div class="menu-price">₱49.75</div>
                 <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="Spanish Coffe.jpg" alt="Americano">
        <div class="menu-name">Americano</div>
        <div class="menu-desc">Espresso with hot water</div>
        <div class="menu-price">₱59.00</div>
                  <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="matcha coffee.jpg" alt="Caramel Macchiato">
        <div class="menu-name">Caramel Macchiato</div>
        <div class="menu-desc">Espresso with caramel and steamed milk</div>
        <div class="menu-price">₱50.00</div>
                <button type="button" onclick="selectItem(this)">Select</button>
      </div>
    </div>
  
    <!-- Milk Tea -->
    <div class="category">Milk Tea</div>
    <div class="scroll-container">
      <div class="menu-card">
        <img src="milktea.jpg" alt="Classic Milk Tea">
        <div class="menu-name">Classic Milk Tea</div>
        <div class="menu-desc">Black tea with creamy milk</div>
        <div class="menu-price">₱50.50</div>
                 <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="Coco-Milk-Tea-3.jpg" alt="Taro Milk Tea">
        <div class="menu-name">Taro Milk Tea</div>
        <div class="menu-desc">Sweet and nutty purple taro</div>
        <div class="menu-price">₱50.00</div>
                  <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="honey-milktea.jpg" alt="Wintermelon Milk Tea">
        <div class="menu-name">Wintermelon Milk Tea</div>
        <div class="menu-desc">Rich and smooth wintermelon flavor</div>
        <div class="menu-price">₱50.75</div>
                  <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="panda-milktea.webp" alt="Matcha Milk Tea">
        <div class="menu-name">Matcha Milk Tea</div>
        <div class="menu-desc">Earthy green tea with creamy milk</div>
        <div class="menu-price">₱50.25</div>
                 <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="mango-milktea.webp" alt="Strawberry Milk Tea">
        <div class="menu-name">Strawberry Milk Tea</div>
        <div class="menu-desc">Fruity and refreshing with tapioca pearls</div>
        <div class="menu-price">₱50.00</div>
                  <button type="button" onclick="selectItem(this)">Select</button>
      </div>
    </div>
  
    <!-- Dessert -->
    <div class="category">Dessert</div>
    <div class="scroll-container">
      <div class="menu-card">
        <img src="cake.jpg" alt="Cheesecake">
        <div class="menu-name">Cheesecake</div>
        <div class="menu-desc">Classic New York-style creamy cheesecake</div>
        <div class="menu-price">₱100.00</div>
                   <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="CHOCOLATE-FUDGE-CAKE-24-S-11.jpg" alt="Chocolate Lava Cake">
        <div class="menu-name">Chocolate Lava Cake</div>
        <div class="menu-desc">Warm cake with gooey chocolate center</div>
        <div class="menu-price">₱90.50</div>
                   <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="japanese-cake.jpg" alt="Tiramisu">
        <div class="menu-name">Tiramisu</div>
        <div class="menu-desc">Coffee-flavored layered Italian dessert</div>
        <div class="menu-price">₱60.75</div>
                 <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="No-bake-cheesecake_8.webp" alt="Red Velvet Cake">
        <div class="menu-name">Red Velvet Cake</div>
        <div class="menu-desc">Moist red cake with cream cheese frosting</div>
        <div class="menu-price">₱60.25</div>
                   <button type="button" onclick="selectItem(this)">Select</button>
      </div>
      <div class="menu-card">
        <img src="Citrus-Chiffon-312JBweb.jpg" alt="Blueberry Tart">
        <div class="menu-name">Blueberry Tart</div>
        <div class="menu-desc">Tart shell filled with custard and berries</div>
        <div class="menu-price">₱50.80</div>
                  <button type="button" onclick="selectItem(this)">Select</button>
      </div>
    </div>
    <!-- Food -->
<div class="category">Food</div>
<div class="scroll-container">
  <div class="menu-card">
    <img src="food.jpg" alt="Spaghetti Bolognese">
    <div class="menu-name">Spaghetti Bolognese</div>
    <div class="menu-desc">Pasta with rich beef and tomato sauce</div>
    <div class="menu-price">₱100.00</div>
              <button type="button" onclick="selectItem(this)">Select</button>
  </div>
  <div class="menu-card">
    <img src="food2.jpg" alt="Chicken Sandwich">
    <div class="menu-name">Chicken Sandwich</div>
    <div class="menu-desc">Grilled chicken with lettuce and mayo</div>
    <div class="menu-price">₱50.50</div>
             <button type="button"> Select</button>
  </div>
  <div class="menu-card">
    <img src="food3.webp" alt="Beef Burger">
    <div class="menu-name">Beef Burger</div>
    <div class="menu-desc">Juicy grilled beef patty with cheese</div>
    <div class="menu-price">₱70.25</div>
              <button type="button" onclick="selectItem(this)">Select</button>
  </div>
  <div class="menu-card">
    <img src="food4.jpg" alt="Fries & Dip">
    <div class="menu-name">Fries & Dip</div>
    <div class="menu-desc">Crispy fries with your choice of dip</div>
    <div class="menu-price">₱30.50</div>
              <button type="button" onclick="selectItem(this)">Select</button>
  </div>
  <div class="menu-card">
    <img src="food4.png" alt="Chicken Nuggets">
    <div class="menu-name">Chicken Nuggets</div>
    <div class="menu-desc">Golden-brown crispy nuggets</div>
    <div class="menu-price">₱40.75</div>
             <button type="button" onclick="selectItem(this)">Select</button>
  </div>
          
</div>
  </section>
 <section id="food-selection-modal" class="modal">
  <div id="food-selection-container" class="food-selection-container">
    <div id="food-details">
    </div>

    <form id="food-order-form">
      <label for="full-name">Full Name:</label>
      <input type="text" id="full-name" required>

      <label for="dine-option">Dine Option:</label>
      <select id="dine-option" required>
        <option value="">Select</option>
        <option value="Take in">Take in</option>
        <option value="Take out">Take out</option>
      </select>

      <button type="button" id="add-payment-btn">Add Payment</button>
    </form>
  </div>
</section>

<section id="payment-method-modal" class="modal">
    <div id="payment-method-container" class="payment-method-container">
      <h3>Select Payment Method</h3>
      <select id="payment-method" required>
        <option value="cash">Cash</option>
        <option value="gcash">Gcash</option>
        <option value="paymaya">Paymaya</option>
      </select>
      <div id="payment-inputs"></div>
      <button id="order-now-btn" class="btn">Order Now</button>
    </div>
  </section>
  
  <section id="review-modal" class="modal">
    <div id="review-container" class="review-container">
      <h3>Review Your Order</h3>
      <ul id="order-summary" class="order-summary"></ul>
      <button id="confirm-btn" class="btn">Confirm</button>
    </div>
  </section>
  <div id="order-history-modal" style="display:none; position:fixed; right:0; top:0; width:300px; height:100%; background:#fff; border-left:1px solid #ccc; overflow-y:auto; padding:20px; z-index:9999;">
  <h3>Order History</h3>
  <ul id="order-history-list"></ul>
  <button id="close-history-btn" style="margin-top: 10px;">Close</button>
</div>
<button onclick="showCart(this)">Get Order</button>

  <div id="overlay"></div>
  <script>
const foodCategoryCards = document.querySelectorAll('.menu-card');
const foodSelectionModal = document.getElementById('food-selection-modal');
const paymentMethodModal = document.getElementById('payment-method-modal');
const reviewModal = document.getElementById('review-modal');
const overlay = document.getElementById('overlay');
const body = document.body;
const menuSection = document.querySelector('.menu-section');
const foodOrderSummary = document.getElementById('order-summary');
const addPaymentBtn = document.getElementById('add-payment-btn');
const paymentMethodSelect = document.getElementById('payment-method');
const paymentInputsContainer = document.getElementById('payment-inputs');
const orderNowBtn = document.getElementById('order-now-btn');
const confirmBtn = document.getElementById('confirm-btn');
const fullNameInput = document.getElementById('full-name');
const dineOptionSelect = document.getElementById('dine-option');
const foodDetailsContainer = document.getElementById('food-details');
const orderHistoryModal = document.getElementById('order-history-modal');
const orderHistoryList = document.getElementById('order-history-list');

let cart = [];
let paymentDetails = {
    method: '',
    cashAmount: 0,
    change: 0
};

function selectItem(button) {
    const card = button.closest('.menu-card');
    const selectedFood = {
        name: card.querySelector('.menu-name').textContent,
        price: card.querySelector('.menu-price').textContent,
        image: card.querySelector('img').src,
        size: 'Regular',
        quantity: 1,
    };

    const existingItemIndex = cart.findIndex(item => item.name === selectedFood.name);
    if (existingItemIndex > -1) {
        cart[existingItemIndex].quantity++;
    } else {
        cart.push(selectedFood);
    }

    // Update styles
    card.style.padding = '10px';
    card.style.border = '2px solid green';
    button.textContent = 'Selected';
    button.style.backgroundColor = 'green';
    button.style.color = 'white';

    alert(`${selectedFood.name} has been added to your cart!`);
}

function showCart() {
    if (cart.length === 0) {
        alert("No items selected yet!");
        return;
    }

    foodDetailsContainer.innerHTML = '';
    cart.forEach((food, index) => {
        foodDetailsContainer.innerHTML += `
            <div style="margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; display: flex; align-items: center;">
                <img src="${food.image}" alt="${food.name}" width="80" height="80" style="margin-right: 10px; border-radius: 4px;">
                <div>
                    <h3>${food.name}</h3>
                    <p>Price: ${food.price}</p>
                    <label>Size:</label>
                    <select onchange="updateItemDetails(${index}, 'size', this.value)">
                        <option value="Regular" ${food.size === 'Regular' ? 'selected' : ''}>Regular</option>
                        <option value="Large" ${food.size === 'Large' ? 'selected' : ''}>Large</option>
                        <option value="Extra Large" ${food.size === 'Extra Large' ? 'selected' : ''}>Extra Large</option>
                    </select>
                    <br>
                    <label>Quantity:</label>
                    <input type="number" value="${food.quantity}" min="1" onchange="updateItemDetails(${index}, 'quantity', this.value)">
                    <br>
                    <button onclick="removeItem(${index})">Remove</button>
                </div>
            </div>
        `;
    });

    menuSection.classList.add('blurred');
    foodSelectionModal.style.display = 'flex';
    overlay.style.display = 'block';
}

function updateItemDetails(index, field, value) {
    cart[index][field] = value;
    showCart();
}

function removeItem(index) {
    cart.splice(index, 1);
    showCart();
}

overlay.addEventListener('click', () => {
    foodSelectionModal.style.display = 'none';
    paymentMethodModal.style.display = 'none';
    reviewModal.style.display = 'none';
    overlay.style.display = 'none';
    menuSection.classList.remove('blurred');
});

addPaymentBtn.addEventListener('click', (e) => {
    if (!fullNameInput.value) {
        alert("Full Name is required.");
        fullNameInput.focus();
        e.preventDefault();
        return;
    }

    if (!dineOptionSelect.value) {
        alert("Please select a dine option.");
        dineOptionSelect.focus();
        e.preventDefault();
        return;
    }

    foodSelectionModal.style.display = 'none';
    paymentMethodModal.style.display = 'flex';
});

paymentMethodSelect.addEventListener('change', () => {
    const method = paymentMethodSelect.value;
    paymentInputsContainer.innerHTML = '';

    if (method === 'cash') {
        paymentInputsContainer.innerHTML = `
            <label>Amount</label>
            <input type="number" id="cash-amount">
            <div id="change-container" style="display:none;">
                <label>Change</label>
                <input type="text" id="change" disabled>
            </div>
        `;
    } else {
        paymentInputsContainer.innerHTML = `
            <label>Username</label>
            <input type="text" id="payment-username">
            <label>Phone Number</label>
            <input type="tel" id="payment-phone">
        `;
    }
});

orderNowBtn.addEventListener('click', () => {
    const fullName = fullNameInput.value;
    const dineOption = dineOptionSelect.value;

    if (!fullName) {
        alert("Full Name is required.");
        fullNameInput.focus();
        return;
    }

    if (!dineOption) {
        alert("Please select a dine option.");
        dineOptionSelect.focus();
        return;
    }

    if (!paymentMethodSelect.value) {
        alert("Select a payment method.");
        return;
    }

    for (let food of cart) {
        if (!food.size || food.quantity <= 0) {
            alert("Check size and quantity.");
            return;
        }
    }

    paymentDetails.method = paymentMethodSelect.value;
    let total = cart.reduce((sum, item) => sum + parseFloat(item.price.replace('$', '')) * item.quantity, 0);

    if (paymentDetails.method === 'cash') {
        const cashInput = document.getElementById('cash-amount');
        const cashAmount = parseFloat(cashInput.value);
        if (isNaN(cashAmount) || cashAmount <= 0) {
            alert("Enter valid cash amount.");
            return;
        }

        if (cashAmount < total) {
            alert(`The cash amount is insufficient. You need at least $${total.toFixed(2)}.`);
            return;
        }

        if (cashAmount > total) {
            let change = cashAmount - total;
            document.getElementById('change').value = `$${change.toFixed(2)}`;
            document.getElementById('change-container').style.display = 'block';
            paymentDetails.change = change;
        }
        paymentDetails.cashAmount = cashAmount;
    } else {
        const username = document.getElementById('payment-username')?.value;
        const phone = document.getElementById('payment-phone')?.value;
        if (!username || !phone) {
            alert("Provide username and phone.");
            return;
        }
    }

    foodOrderSummary.innerHTML = `
        <li><strong>Full Name:</strong> ${fullName}</li>
        <li><strong>Dine Option:</strong> ${dineOption}</li>
        <li><strong>Items:</strong></li>
        <ul>
            ${cart.map(item => `
                <li>
                    ${item.name} - ${item.price} | Size: ${item.size} | Quantity: ${item.quantity}
                </li>`).join('')}
        </ul>
        <li><strong>Total:</strong> $${total.toFixed(2)}</li>
        <li><strong>Payment Method:</strong> ${paymentDetails.method}</li>
        ${paymentDetails.method === 'cash' ? `<li>Paid: $${paymentDetails.cashAmount}</li>` : ''}
        ${paymentDetails.change ? `<li>Change: $${paymentDetails.change.toFixed(2)}</li>` : ''}
    `;

    paymentMethodModal.style.display = 'none';
    reviewModal.style.display = 'flex';
});

confirmBtn.addEventListener('click', () => {
    const fullName = fullNameInput.value;
    const dineOption = dineOptionSelect.value;
    let total = cart.reduce((sum, item) => sum + parseFloat(item.price.replace('$', '')) * item.quantity, 0);

    const newOrder = {
        fullName,
        dineOption,
        items: cart,
        total: total.toFixed(2),
        paymentMethod: paymentDetails.method,
        timestamp: new Date().toLocaleString(),
    };

    const history = JSON.parse(localStorage.getItem('orderHistory')) || [];
    history.push(newOrder);
    localStorage.setItem('orderHistory', JSON.stringify(history));

    alert("Order confirmed!");
    
    // Clear the cart and reset item styles after order confirmation
    cart = [];
    foodCategoryCards.forEach(card => {
        const button = card.querySelector('button');
        card.style.padding = '';
        card.style.border = '';
        button.textContent = 'Add to Cart';
        button.style.backgroundColor = '';
        button.style.color = '';
    });

    reviewModal.style.display = 'none';
    overlay.style.display = 'none';
    menuSection.classList.remove('blurred');
    fullNameInput.value = '';
    dineOptionSelect.value = '';
    paymentInputsContainer.innerHTML = '';
    paymentMethodSelect.value = '';
});

function showOrderHistory() {
    const history = JSON.parse(localStorage.getItem('orderHistory')) || [];
    const currentTime = new Date().getTime();  // Get current time in milliseconds

    // Filter out orders that were marked as 'Received' and are older than 10 seconds
    const filteredHistory = history.filter(order => {
        if (order.status === 'Received') {
            const orderTime = new Date(order.timestamp).getTime(); // Convert timestamp to milliseconds
            const timeDiff = currentTime - orderTime;
            if (timeDiff > 10000) {  // If more than 10 seconds have passed
                return false;  // Remove the order from history
            }
        }
        return true;  // Keep the order if it doesn't meet the criteria
    });

    // Update the order history in localStorage
    localStorage.setItem('orderHistory', JSON.stringify(filteredHistory));

    // Render the updated order history
    orderHistoryList.innerHTML = filteredHistory.map((order, index) => {
        const itemList = order.items.map(item => `
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                <img src="${item.image}" alt="${item.name}" style="width: 40px; height: 40px; border-radius: 6px; object-fit: cover;">
                <div>
                    <strong>${item.name}</strong> x${item.quantity} <br>
                    <small>$${item.price} each</small>
                </div>
            </div>
        `).join('');

        const status = order.status || 'On Process';
        const statusColors = {
            'On Process': '#007BFF',
            'Pending': '#FFA500',
            'Delivered': '#28a745',
            'Received': '#6c757d'
        };

        return `
            <li style="border-bottom: 1px solid #ccc; margin-bottom: 10px; padding-bottom: 10px;">
                <strong>${order.fullName}</strong><br>
                <em>Dine Option: ${order.dineOption || 'N/A'}</em>
                ${itemList}
                <div><strong>Total:</strong> $${order.total}</div>
                <button 
                    onclick="toggleOrderStatus(${index})"
                    style="margin-top: 5px;
                        padding: 5px 12px;
                        background-color: ${statusColors[status]};
                        color: white;
                        border: none;
                        border-radius: 5px;
                        cursor: pointer;">
                    ${status}
                </button>
                <br><small>${order.timestamp}</small>
            </li>
        `;
    }).join('');

    orderHistoryModal.style.display = 'block';
}


function toggleOrderStatus(index) {
    const history = JSON.parse(localStorage.getItem('orderHistory')) || [];
    const statuses = ['On Process', 'Pending', 'Delivered', 'Received'];
    const currentStatus = history[index].status || 'On Process';
    const nextIndex = (statuses.indexOf(currentStatus) + 1) % statuses.length;

 
    history[index].status = statuses[nextIndex];
    localStorage.setItem('orderHistory', JSON.stringify(history));

   
    if (statuses[nextIndex] === 'Received') {
       
        const orderElement = document.querySelector(`#order-${index}`);
        if (orderElement) {
            const receivedText = document.createElement('span');
            receivedText.textContent = 'Received';
            receivedText.style.color = 'green';  
            orderElement.appendChild(receivedText);
        }

        
        setTimeout(() => {
           
            history.splice(index, 1);
            localStorage.setItem('orderHistory', JSON.stringify(history));

            
            showOrderHistory();
        }, 10000); 
    }

  
    showOrderHistory();
}
function toggleOrderStatus(index) {
    const history = JSON.parse(localStorage.getItem('orderHistory')) || [];
    const statuses = ['On Process', 'Pending', 'Delivered', 'Received'];
    const currentStatus = history[index].status || 'On Process';
    const nextIndex = (statuses.indexOf(currentStatus) + 1) % statuses.length;

    history[index].status = statuses[nextIndex];
    localStorage.setItem('orderHistory', JSON.stringify(history));

    if (statuses[nextIndex] === 'Received') {
        const orderElement = document.querySelector(`#order-${index}`);
        if (orderElement) {
            const receivedText = document.createElement('span');
            receivedText.textContent = ' Received';
            receivedText.style.color = 'green';
            orderElement.appendChild(receivedText);
        }

        setTimeout(() => {
            history.splice(index, 1);
            localStorage.setItem('orderHistory', JSON.stringify(history));
            showOrderHistory();
        }, 10000);
    }

    showOrderHistory();
}

function showOrderHistory() {
    const history = JSON.parse(localStorage.getItem('orderHistory')) || [];
    orderHistoryList.innerHTML = history.map((order, index) => {
        const itemList = order.items.map(item => `
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 8px;">
                <img src="${item.image}" alt="${item.name}" style="width: 40px; height: 40px; border-radius: 6px; object-fit: cover;">
                <div>
                    <strong>${item.name}</strong> x${item.quantity} <br>
                    <small>$${item.price} each</small>
                </div>
            </div>
        `).join('');

        const status = order.status || 'On Process';
        const statusColors = {
            'On Process': '#007BFF',
            'Pending': '#FFA500',
            'Delivered': '#28a745',
            'Received': '#6c757d'
        };

        return `
            <li id="order-${index}" style="border-bottom: 1px solid #ccc; margin-bottom: 10px; padding-bottom: 10px;">
                <strong>${order.fullName}</strong><br>
                <em>Dine Option: ${order.dineOption || 'N/A'}</em>
                ${itemList}
                <div><strong>Total:</strong> $${order.total}</div>
                <button 
                    onclick="toggleOrderStatus(${index})"
                    style="margin-top: 5px;
                        padding: 5px 12px;
                        background-color: ${statusColors[status]};
                        color: white;
                        border: none;
                        border-radius: 5px;
                        cursor: pointer;">
                    ${status}
                </button>
                <br><small>${order.timestamp}</small>
            </li>
        `;
    }).join('');

    orderHistoryModal.style.display = 'block';
}


document.getElementById('close-history-btn').addEventListener('click', function () {
    orderHistoryModal.style.display = 'none';
});
</script>

</body>
</html>